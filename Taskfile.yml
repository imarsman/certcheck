version: "3"

vars:
  hostList: >
    google.com cisco.com ibm.com microsoft.com aws.com www.gov.za amazon.com
tasks:
  build:
    desc: build app
    dir: cmd/certcheck
    cmds:
      - rm -f ../../build/certcheck
      - go build -o ../../build/certcheck .
      - cmd: rm ~/bin/certcheck
        ignore_error: true
      - cmd: cp ../../build/certcheck ~/bin/
        ignore_error: true
  test:
    desc: test app
    dir: build
    cmds:
      - task: build
      - time echo "{{.hostList}}" | ./certcheck
      - go test -v ../...
